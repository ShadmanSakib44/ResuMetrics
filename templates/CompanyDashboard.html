{% extends "base.html" %}
{% block title %}HR Dashboard{% endblock %}
{% block Addnav %}
<li class="nav-item active">
  <a class="nav-link" href="/HR1/post_job">Post Job</a>
</li>
<li class="nav-item active">
                    <a class="nav-link" style="z-index: 10; color: #333; font-size: 18px;" href="/logout">Logout</a>
                </li>
{% endblock %}
{% block content %}
<style>
  /* Custom styles for this page */
  .container {
    margin-top: 20px;
  }

  .categoryInput1 {
    margin-top: 20px;
  }

  @media screen and (max-width: 560px) {
    #categoryInput {
      width: 100%;
    }
    input.sBto {
      width: 100%;
      height: 40px;
      margin-bottom: 20px;
    }
  }

  @media screen and (min-width: 560px) {
    input.sBto {
      width: 60%;
      margin-left: 20%;
      height: 50px;
      margin-bottom: 50px;
    }
  }

  .table-responsive-sm {
    overflow-x: auto;
  }
</style>
<div class="container">
  <div class="row">
    <h2>{{ errorMsg }}</h2>
    <div class="col-xs-12">
      <form class="form-horizontal" action="/empSearch" method="POST">
        <div class="form-floating mb-3 categoryInput1">
          <input
            type="text"
            name="category"
            id="categoryInput"
            class="form-control"
          />
          <label for="categoryInput">Enter Job Title:</label>
        </div>
        <div class="form-group">
          <input
            type="submit"
            class="btn btn-danger sBto"
            name="submit"
            value="Search"
            style="background-color: #1260cc;"
          />
        </div>
      </form>
    </div>
  </div>
  <div class="row">
    <div class="col-xs-12 table-responsive-sm">
      <table class="table table-bordered">
        <thead>
          <tr>
            <th class="text-center">No</th>
            <th class="text-center">Name</th>
            <th class="text-center">Email</th>
            <th class="text-center">Details</th>
          </tr>
        </thead>
        <tbody>
          {% for i in range(0, data|length) %}
          <tr>
            <td class="text-center">{{ (i+1) }}</td>
            <td class="text-center">{{ data[i]['Name'] }}</td>
            <td class="text-center">{{ data[i]['Email'] }}</td>
            <td>
              <input
                type="button"
                name="view"
                value="View"
                id="{{ data[i]['_id'] }}"
                data-bs-toggle="modal"
                data-bs-target="#viewdetails"
                class="btn btn-secondary view_data"
                style="margin-left: 10%"
              />
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>
<div class="modal fade" id="viewdetails" tabindex="-1" role="dialog" aria-labelledby="viewdetails" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-fullscreen-sm-down" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title" id="exampleModalLongTitle">
          Details of Candidate:
        </h3>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <table class="table table-responsive">
          <tr>
            <th><label><strong>Name:</strong></label></th>
            <td>
              <input type="text" class="form-control-plaintext" readonly id="view_name" />
            </td>
          </tr>
          <tr>
            <th><label><strong>LinkedIn Profile:</strong></label></th>
            <td>
              <a href="#" id="view_linkedin_link" target="_blank">LinkedIn Profile</a>
            </td>
          </tr>
          <tr>
            <th><label><strong>Skills:</strong></label></th>
            <td>
              <input type="text" class="form-control-plaintext" readonly id="view_skills" />
            </td>
          </tr>
          <tr>
            <th><label><strong>Certification:</strong></label></th>
            <td>
              <input type="text" class="form-control-plaintext" readonly id="view_certificates" />
            </td>
          </tr>
        </table>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" aria-label="Close">Close</button>
      </div>
    </div>
  </div>
</div>
<script>
  $(document).on("click", ".view_data", function () {
    var employee_id = $(this).attr("id");
    $j.ajax({
      url: "/viewdetails",
      method: "POST",
      data: { employee_id: employee_id },
      success: function (data) {
        $("#view_name").val(data.name);
        $("#view_linkedin_link").val(data.linkedin_link);
        $("#view_skills").val(data.skills);
        $("#view_certificates").val(data.certificate);
      },
    });
  });
</script>
{% endblock %}
